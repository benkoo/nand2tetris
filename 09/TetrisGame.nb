(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     60042,       1540]
NotebookOptionsPosition[     59517,       1516]
NotebookOutlinePosition[     59876,       1532]
CellTagsIndexPosition[     59833,       1529]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["A Tetris Game Demo", "Title",
 CellChangeTimes->{{3.6883500994395733`*^9, 3.688350104166593*^9}}],

Cell[CellGroupData[{

Cell["This is originally written by Xiaodong Wen", "Subchapter",
 CellChangeTimes->{{3.688350108517441*^9, 3.6883501197990932`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allBlocks", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "2", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2", ",", "2", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "2", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "3", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "3", ",", "3", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "4", ",", "4", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "4", ",", "4", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "4", ",", "4", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "4", ",", "4", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "4", ",", "4", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "4", ",", "4", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "4", ",", "4", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "4", ",", "4", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "5", ",", "5", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "5", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "5", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "5", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "5", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "5", ",", "5", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "5", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "5", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "5", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "5", ",", "0"}], "}"}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "6", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "6", ",", "6", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "6", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "6", ",", "6", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "6", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "6", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "6", ",", "6", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "6", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "6", ",", "6", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "6", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "7", ",", "7", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "7", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "7", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "7", ",", "7", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "7", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "7", ",", "7", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "7", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "7", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "7", ",", "7", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "7", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"smallBoard", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "\[Equal]", "1"}], "||", 
         RowBox[{"j", "\[Equal]", "1"}], "||", 
         RowBox[{"i", "\[Equal]", "6"}], "||", 
         RowBox[{"j", "\[Equal]", "6"}]}], ",", "9", ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"color", "[", "v_", "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{
    "v", ",", "0", ",", "Black", ",", "1", ",", "Yellow", ",", "2", ",", 
     "Blue", ",", "3", ",", "Magenta", ",", "4", ",", "Cyan", ",", "5", ",", 
     "Red", ",", "6", ",", "Orange", ",", "7", ",", "Green", ",", "9", ",", 
     "Gray", ",", "_", ",", "Gray"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"showSquare", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}], ",", "v_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"color", "[", "v", "]"}], ",", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"i", "+", "0.05"}], ",", 
         RowBox[{"j", "+", "0.05"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"i", "+", "0.95"}], ",", 
         RowBox[{"j", "+", "0.95"}]}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"showHintBlock", "[", 
     RowBox[{"n_", ",", "p_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"showSquare", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "+", "x"}], ",", 
          RowBox[{"j", "+", "y"}]}], "}"}], ",", 
        RowBox[{"allBlocks", "[", 
         RowBox[{"[", 
          RowBox[{"n", ",", "p", ",", "i", ",", "j"}], "]"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"initBoard", "[", 
     RowBox[{"Hold", "[", 
      RowBox[{"board_", ",", "num_"}], "]"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"board", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[LessEqual]", "3"}], "||", 
            RowBox[{"j", "\[LessEqual]", "3"}], "||", 
            RowBox[{"i", "\[GreaterEqual]", "14"}], "||", 
            RowBox[{"j", "\[GreaterEqual]", "24"}]}], ",", "9", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "16"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "28"}], "}"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"board", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "24"}], "]"}], "]"}], "=", "0"}], ";", 
          RowBox[{
           RowBox[{"board", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "25"}], "]"}], "]"}], "=", "0"}], ";", 
          RowBox[{
           RowBox[{"board", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "26"}], "]"}], "]"}], "=", "0"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "7", ",", "10"}], "}"}]}], "]"}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"board", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "25"}], "]"}], "]"}], "=", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "16"}], "}"}]}], "]"}], ";", 
       RowBox[{
        RowBox[{"board", "[", 
         RowBox[{"[", 
          RowBox[{"6", ",", "25"}], "]"}], "]"}], "=", "9"}]}], ",", 
      RowBox[{
       RowBox[{"board", "[", 
        RowBox[{"[", 
         RowBox[{"11", ",", "25"}], "]"}], "]"}], "=", "9"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"j", "+", "i"}], ",", "2"}], "]"}], "\[Equal]", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"board", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", 
              RowBox[{"i", "+", "3"}]}], "]"}], "]"}], "=", "9"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "num"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "4", ",", "13"}], "}"}]}], "]"}]}], "}"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bMoveTo", "[", 
    RowBox[{"n_", ",", "p_", ",", "x_", ",", "y_", ",", 
     RowBox[{"Hold", "[", "board_", "]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"allBlocks", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "p", ",", "i", ",", "j"}], "]"}], "]"}], "*", 
         " ", 
         RowBox[{"board", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "+", "x"}], ",", 
            RowBox[{"j", "+", "y"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "2"}], "]"}],
     "\[Equal]", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bGameOver", "[", 
    RowBox[{"n_", ",", "p_", ",", 
     RowBox[{"Hold", "[", "board_", "]"}]}], "]"}], ":=", 
   RowBox[{"Not", "[", 
    RowBox[{"bMoveTo", "[", 
     RowBox[{"n", ",", "p", ",", "6", ",", "22", ",", 
      RowBox[{"Hold", "[", "board", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bLeft", "[", 
    RowBox[{"n_", ",", "p_", ",", "x_", ",", "y_", ",", 
     RowBox[{"Hold", "[", "board_", "]"}]}], "]"}], ":=", 
   RowBox[{"bMoveTo", "[", 
    RowBox[{"n", ",", "p", ",", 
     RowBox[{"x", "-", "1"}], ",", "y", ",", 
     RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bRight", "[", 
    RowBox[{"n_", ",", "p_", ",", "x_", ",", "y_", ",", 
     RowBox[{"Hold", "[", "board_", "]"}]}], "]"}], ":=", 
   RowBox[{"bMoveTo", "[", 
    RowBox[{"n", ",", "p", ",", 
     RowBox[{"x", "+", "1"}], ",", "y", ",", 
     RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bDown", "[", 
    RowBox[{"n_", ",", "p_", ",", "x_", ",", "y_", ",", 
     RowBox[{"Hold", "[", "board_", "]"}]}], "]"}], ":=", 
   RowBox[{"bMoveTo", "[", 
    RowBox[{"n", ",", "p", ",", "x", ",", 
     RowBox[{"y", "-", "1"}], ",", 
     RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bRotateAnticlock", "[", 
    RowBox[{"n_", ",", "p_", ",", "x_", ",", "y_", ",", 
     RowBox[{"Hold", "[", "board_", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tp", "}"}], ",", 
     RowBox[{
      RowBox[{"tp", "=", 
       RowBox[{"p", "-", "1"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"tp", "\[Equal]", "0"}], ",", 
        RowBox[{"tp", "=", "4"}]}], "]"}], ";", 
      RowBox[{"bMoveTo", "[", 
       RowBox[{"n", ",", "tp", ",", "x", ",", "y", ",", 
        RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"bRotateClockwise", "[", 
    RowBox[{"n_", ",", "p_", ",", "x_", ",", "y_", ",", 
     RowBox[{"Hold", "[", "board_", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tp", "}"}], ",", 
     RowBox[{
      RowBox[{"tp", "=", 
       RowBox[{"p", "+", "1"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"tp", "\[Equal]", "5"}], ",", 
        RowBox[{"tp", "=", "1"}]}], "]"}], ";", 
      RowBox[{"bMoveTo", "[", 
       RowBox[{"n", ",", "tp", ",", "x", ",", "y", ",", 
        RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"showBoard", "[", 
    RowBox[{"Hold", "[", "board_", "]"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"showSquare", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       RowBox[{"board", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3", ",", "25"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"showDropBlock", "[", 
     RowBox[{"n_", ",", "p_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"allBlocks", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "p", ",", "i", ",", "j"}], "]"}], "]"}], 
         "\[NotEqual]", "0"}], ",", 
        RowBox[{"showSquare", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "+", "x"}], ",", 
            RowBox[{"j", "+", "y"}]}], "}"}], ",", 
          RowBox[{"allBlocks", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "p", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         "]"}], ",", "Black"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"updateBoard", "[", 
    RowBox[{"n_", ",", "p_", ",", "x_", ",", "y_", ",", 
     RowBox[{"Hold", "[", 
      RowBox[{"board_", ",", "score_"}], "]"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"board", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "+", "x"}], ",", 
           RowBox[{"j", "+", "y"}]}], "]"}], "]"}], "+=", 
        RowBox[{"allBlocks", "[", 
         RowBox[{"[", 
          RowBox[{"n", ",", "p", ",", "i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ";", 
     RowBox[{"score", "+=", 
      RowBox[{"10", "+", 
       RowBox[{"100", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "^", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"updateLine", "[", 
              RowBox[{"i", ",", 
               RowBox[{"Hold", "[", "board", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"y", "+", "4"}], ",", 
               RowBox[{"y", "+", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "-", "1"}], 
         ")"}]}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"updateLine", "[", 
    RowBox[{"line_", ",", 
     RowBox[{"Hold", "[", "board_", "]"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"line", "\[LessEqual]", "23"}], "&&", 
      RowBox[{"line", "\[GreaterEqual]", "4"}], "&&", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"board", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "line"}], "]"}], "]"}], "\[NotEqual]", "0"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "4", ",", "13"}], "}"}]}], "]"}]}], "]"}], 
        ")"}], "\[Equal]", "True"}]}], ",", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"board", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", " ", 
         RowBox[{"board", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "4", ",", "13"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "line", ",", "22"}], "}"}]}], "]"}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"board", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "23"}], "]"}], "]"}], "=", " ", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "4", ",", "13"}], "}"}]}], "]"}], ";", "1"}], ",", 
     "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newGame", "[", 
    RowBox[{"Hold", "[", 
     RowBox[{
     "n_", ",", "p_", ",", "x_", ",", "y_", ",", "board_", ",", "nextItem_", 
      ",", "gameOver_", ",", "pause_", ",", "num_"}], "]"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"initBoard", "[", 
      RowBox[{"Hold", "[", 
       RowBox[{"board", ",", "num"}], "]"}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "p", ",", "x", ",", "y"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"nextItem", ",", "2", ",", "6", ",", "22"}], "}"}]}], ";", 
     RowBox[{"nextItem", "=", 
      RowBox[{
       RowBox[{"RandomInteger", "[", "6", "]"}], "+", "1"}]}], ";", 
     RowBox[{"gameOver", "=", "False"}], ";", 
     RowBox[{"pause", " ", "=", " ", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"newBlock", "[", 
     RowBox[{"Hold", "[", 
      RowBox[{
      "n_", ",", "p_", ",", "x_", ",", "y_", ",", "board_", ",", "score_", 
       ",", "gameOver_", ",", "nextItem_", ",", "pause_"}], "]"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", "pause"}], "&&", 
        RowBox[{"!", "gameOver"}]}], ",", 
       RowBox[{
        RowBox[{"updateBoard", "[", 
         RowBox[{"n", ",", "p", ",", "x", ",", "y", ",", 
          RowBox[{"Hold", "[", 
           RowBox[{"board", ",", "score"}], "]"}]}], "]"}], ";", 
        RowBox[{"gameOver", "=", 
         RowBox[{"bGameOver", "[", 
          RowBox[{"nextItem", ",", "2", ",", 
           RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"gameOver", "\[Equal]", "False"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", ",", "p", ",", "x", ",", "y"}], "}"}], " ", "=", 
            RowBox[{"{", 
             RowBox[{"nextItem", ",", "2", ",", "6", ",", "22"}], "}"}]}], 
           ";", 
           RowBox[{"nextItem", "=", 
            RowBox[{
             RowBox[{"RandomInteger", "[", "6", "]"}], "+", "1"}]}]}]}], 
         "]"}]}]}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"shapeDescend", "[", 
    RowBox[{"Hold", "[", 
     RowBox[{"level_", ",", "state_", ",", "num_"}], "]"}], "]"}], ":=", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"score", "=", "0"}], ",", 
       RowBox[{"gameOver", "=", "False"}], ",", 
       RowBox[{"pause", "=", "False"}], ",", 
       RowBox[{"board", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "\[LessEqual]", "3"}], "||", 
             RowBox[{"j", "\[LessEqual]", "3"}], "||", 
             RowBox[{"i", "\[GreaterEqual]", "14"}], "||", 
             RowBox[{"j", "\[GreaterEqual]", "24"}]}], ",", "0", ",", "0"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "16"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "28"}], "}"}]}], "]"}]}], ",", "n", 
       ",", "p", ",", "x", ",", "y", ",", "nextItem"}], "}"}], ",", 
     RowBox[{
      RowBox[{"SeedRandom", "[", 
       RowBox[{
        RowBox[{"level", "*", "10"}], "+", "num"}], "]"}], ";", 
      RowBox[{"nextItem", "=", 
       RowBox[{
        RowBox[{"RandomInteger", "[", "6", "]"}], "+", "1"}]}], ";", 
      RowBox[{"newGame", "[", 
       RowBox[{"Hold", "[", 
        RowBox[{
        "n", ",", "p", ",", "x", ",", "y", ",", "board", ",", "nextItem", ",",
          "gameOver", ",", "pause", ",", "num"}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EventHandler", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<Level\>\"", ",", "Blue", ",", "Italic", ",", "24"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"18", ",", "12"}], "}"}]}], "]"}], ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<Score\>\"", ",", "Blue", ",", "Italic", ",", "24"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"18", ",", "9"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"showSquare", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"i", "+", "16"}], ",", 
                  RowBox[{"j", "+", "13"}]}], "}"}], ",", 
                RowBox[{"smallBoard", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Refresh", "[", 
                RowBox[{
                 RowBox[{"Switch", "[", 
                  RowBox[{"state", ",", "1", ",", 
                   RowBox[{
                    RowBox[{"newGame", "[", 
                    RowBox[{"Hold", "[", 
                    RowBox[{
                    "n", ",", "p", ",", "x", ",", "y", ",", "board", ",", 
                    "nextItem", ",", "gameOver", ",", "pause", ",", "num"}], 
                    "]"}], "]"}], ";", 
                    RowBox[{"state", "=", "3"}]}], ",", "\[IndentingNewLine]",
                    "2", ",", 
                   RowBox[{"pause", " ", "=", " ", "True"}], ",", 
                   "\[IndentingNewLine]", "3", ",", 
                   RowBox[{"pause", " ", "=", " ", "False"}]}], "]"}], ",", 
                 RowBox[{"UpdateInterval", "\[Rule]", "Infinity"}], ",", 
                 RowBox[{"TrackedSymbols", "\[Rule]", 
                  RowBox[{"{", "state", "}"}]}]}], "]"}], ";", 
               RowBox[{"Refresh", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"!", "pause"}], " ", "&&", " ", 
                    RowBox[{"!", "gameOver"}], " ", "&&", 
                    RowBox[{"bDown", "[", 
                    RowBox[{"n", ",", "p", ",", "x", ",", "y", ",", 
                    RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}], ",", 
                   RowBox[{"y", "--"}], ",", 
                   RowBox[{"newBlock", "[", 
                    RowBox[{"Hold", "[", 
                    RowBox[{
                    "n", ",", "p", ",", "x", ",", "y", ",", "board", ",", 
                    "score", ",", "gameOver", ",", "nextItem", ",", "pause"}],
                     "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"UpdateInterval", "\[Rule]", 
                  RowBox[{"3.", "/", "level"}]}], ",", 
                 RowBox[{"TrackedSymbols", "\[Rule]", 
                  RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "level", "]"}], ",", "Green", 
                    ",", "Italic", ",", "24"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"20", ",", "11"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "score", "]"}], ",", "Green", 
                    ",", "Italic", ",", "24"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"20", ",", "8"}], "}"}]}], "]"}]}], "}"}], "}"}], 
                 ",", 
                 RowBox[{"showBoard", "[", 
                  RowBox[{"Hold", "[", "board", "]"}], "]"}], ",", 
                 RowBox[{"showDropBlock", "[", 
                  RowBox[{"n", ",", "p", ",", "x", ",", "y"}], "]"}], ",", 
                 RowBox[{"showHintBlock", "[", 
                  RowBox[{"nextItem", ",", "2", ",", "17", ",", "14"}], 
                  "]"}]}], "]"}]}], ",", 
              RowBox[{"TrackedSymbols", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "n", ",", "p", ",", "level"}], 
                "}"}]}]}], "]"}]}], "}"}], ",", 
          RowBox[{"Background", "\[Rule]", "Black"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"400", ",", "400"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"!", "pause"}], " ", "&&", " ", 
              RowBox[{"!", "gameOver"}], " ", "&&", " ", 
              RowBox[{"bLeft", "[", 
               RowBox[{"n", ",", "p", ",", "x", ",", "y", ",", 
                RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}], ",", 
             RowBox[{"x", "--"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"!", "pause"}], " ", "&&", " ", 
              RowBox[{"!", "gameOver"}], " ", "&&", " ", 
              RowBox[{"bRight", "[", 
               RowBox[{"n", ",", "p", ",", "x", ",", "y", ",", 
                RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}], ",", 
             RowBox[{"x", "++"}]}], "]"}]}], ",", 
          RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"!", "pause"}], " ", "&&", " ", 
               RowBox[{"!", "gameOver"}], " ", "&&", " ", 
               RowBox[{"bRotateClockwise", "[", 
                RowBox[{"n", ",", "p", ",", "x", ",", "y", ",", 
                 RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"p", "++"}], ";", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"p", "\[Equal]", "5"}], ",", 
                 RowBox[{"p", "=", "1"}]}], "]"}]}]}], "]"}], ")"}]}], ",", 
          RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"!", "pause"}], " ", "&&", " ", 
               RowBox[{"!", "gameOver"}], " ", "&&", " ", 
               RowBox[{"bRotateAnticlock", "[", 
                RowBox[{"n", ",", "p", ",", "x", ",", "y", ",", 
                 RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"p", "--"}], ";", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"p", "\[Equal]", "0"}], ",", 
                 RowBox[{"p", "=", "4"}]}], "]"}]}]}], "]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<KeyDown\>\"", ",", "\"\< \>\""}], "}"}], 
           "\[RuleDelayed]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"!", "pause"}], " ", "&&", " ", 
              RowBox[{"!", "gameOver"}], " ", "&&", " ", 
              RowBox[{"bDown", "[", 
               RowBox[{"n", ",", "p", ",", "x", ",", "y", ",", 
                RowBox[{"Hold", "[", "board", "]"}]}], "]"}]}], ",", 
             RowBox[{"y", "--"}], ",", 
             RowBox[{"newBlock", "[", 
              RowBox[{"Hold", "[", 
               RowBox[{
               "n", ",", "p", ",", "x", ",", "y", ",", "board", ",", "score", 
                ",", "gameOver", ",", "nextItem", ",", "pause"}], "]"}], 
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<EscapeKeyDown\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"newGame", "[", 
             RowBox[{"Hold", "[", 
              RowBox[{
              "n", ",", "p", ",", "x", ",", "y", ",", "board", ",", 
               "nextItem", ",", "gameOver", ",", "pause", ",", "num"}], "]"}],
              "]"}], "}"}]}]}], "}"}]}], "]"}]}]}], "]"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"shapeDescend", "[", 
    RowBox[{"Hold", "[", 
     RowBox[{"level", ",", "state", ",", "initLine"}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"level", ",", "5"}], "}"}], ",", "1", ",", "9", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"initLine", ",", "3", ",", "\"\<height of bottom level\>\""}], 
      "}"}], ",", "0", ",", "9", ",", "1"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"state", ",", "3", ",", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<new game\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<pause\>\""}], ",", 
       RowBox[{"3", "\[Rule]", "\"\<continue\>\""}]}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContentSize", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"480", ",", "450"}], "}"}]}], ",", 
   RowBox[{"SynchronousUpdating", "\[Rule]", "False"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
   RowBox[{"TrackedSymbols", "\[Rule]", 
    RowBox[{"{", "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`initLine$$ = 3, $CellContext`level$$ = 
    5, $CellContext`state$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`level$$], 5}, 1, 9, 1}, {{
       Hold[$CellContext`initLine$$], 3, "height of bottom level"}, 0, 9, 
      1}, {{
       Hold[$CellContext`state$$], 3, ""}, {
      1 -> "new game", 2 -> "pause", 3 -> "continue"}}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`level$17756$$ = 
    0, $CellContext`initLine$17757$$ = 0, $CellContext`state$17758$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`initLine$$ = 3, $CellContext`level$$ = 
        5, $CellContext`state$$ = 3}, "ControllerVariables" :> {
        Hold[$CellContext`level$$, $CellContext`level$17756$$, 0], 
        Hold[$CellContext`initLine$$, $CellContext`initLine$17757$$, 0], 
        Hold[$CellContext`state$$, $CellContext`state$17758$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> $CellContext`shapeDescend[
        Hold[$CellContext`level$$, $CellContext`state$$, \
$CellContext`initLine$$]], 
      "Specifications" :> {{{$CellContext`level$$, 5}, 1, 9, 
         1}, {{$CellContext`initLine$$, 3, "height of bottom level"}, 0, 9, 
         1}, {{$CellContext`state$$, 3, ""}, {
         1 -> "new game", 2 -> "pause", 3 -> "continue"}}}, 
      "Options" :> {
       ContentSize -> {480, 450}, SynchronousUpdating -> False, Alignment -> 
        Center, TrackedSymbols -> {}}, "DefaultOptions" :> {}],
     ImageSizeCache->{494., {283., 288.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`shapeDescend[
         Hold[
          Pattern[$CellContext`level, 
           Blank[]], 
          Pattern[$CellContext`state, 
           Blank[]], 
          Pattern[$CellContext`num, 
           Blank[]]]] := 
       DynamicModule[{$CellContext`score = 0, $CellContext`gameOver = 
          False, $CellContext`pause = False, $CellContext`board = Table[
            If[
             
             Or[$CellContext`i <= 3, $CellContext`j <= 3, $CellContext`i >= 
              14, $CellContext`j >= 24], 0, 0], {$CellContext`i, 1, 
             16}, {$CellContext`j, 1, 
             28}], $CellContext`n, $CellContext`p, $CellContext`x, \
$CellContext`y, $CellContext`nextItem}, 
         SeedRandom[$CellContext`level 
            10 + $CellContext`num]; $CellContext`nextItem = 
          RandomInteger[6] + 1; $CellContext`newGame[
           
           Hold[$CellContext`n, $CellContext`p, $CellContext`x, \
$CellContext`y, $CellContext`board, $CellContext`nextItem, \
$CellContext`gameOver, $CellContext`pause, $CellContext`num]]; EventHandler[
           Graphics[{
             Text[
              Style["Level", Blue, Italic, 24], {18, 12}], 
             Text[
              Style["Score", Blue, Italic, 24], {18, 9}], 
             Table[
              $CellContext`showSquare[{$CellContext`i + 16, $CellContext`j + 
                13}, 
               
               Part[$CellContext`smallBoard, $CellContext`i, \
$CellContext`j]], {$CellContext`i, 1, 6}, {$CellContext`j, 1, 6}], 
             Dynamic[Refresh[
                Switch[$CellContext`state, 1, $CellContext`newGame[
                   
                   Hold[$CellContext`n, $CellContext`p, $CellContext`x, \
$CellContext`y, $CellContext`board, $CellContext`nextItem, \
$CellContext`gameOver, $CellContext`pause, $CellContext`num]]; \
$CellContext`state = 3, 2, $CellContext`pause = True, 3, $CellContext`pause = 
                 False], UpdateInterval -> Infinity, 
                TrackedSymbols -> {$CellContext`state}]; Refresh[
                If[
                 And[
                  Not[$CellContext`pause], 
                  Not[$CellContext`gameOver], 
                  $CellContext`bDown[$CellContext`n, $CellContext`p, \
$CellContext`x, $CellContext`y, 
                   Hold[$CellContext`board]]], 
                 Decrement[$CellContext`y], 
                 $CellContext`newBlock[
                  
                  Hold[$CellContext`n, $CellContext`p, $CellContext`x, \
$CellContext`y, $CellContext`board, $CellContext`score, \
$CellContext`gameOver, $CellContext`nextItem, $CellContext`pause]]], 
                UpdateInterval -> 3./$CellContext`level, 
                TrackedSymbols -> {}]; Join[{{
                  Text[
                   Style[
                    ToString[$CellContext`level], Green, Italic, 24], {20, 
                   11}], 
                  Text[
                   Style[
                    ToString[$CellContext`score], Green, Italic, 24], {20, 
                   8}]}}, 
                $CellContext`showBoard[
                 Hold[$CellContext`board]], 
                $CellContext`showDropBlock[$CellContext`n, $CellContext`p, \
$CellContext`x, $CellContext`y], 
                $CellContext`showHintBlock[$CellContext`nextItem, 2, 17, 14]],
               TrackedSymbols -> {$CellContext`x, $CellContext`y, \
$CellContext`n, $CellContext`p, $CellContext`level}]}, Background -> Black, 
            ImageSize -> {400, 400}], {"LeftArrowKeyDown" :> If[
              And[
               Not[$CellContext`pause], 
               Not[$CellContext`gameOver], 
               $CellContext`bLeft[$CellContext`n, $CellContext`p, \
$CellContext`x, $CellContext`y, 
                Hold[$CellContext`board]]], 
              Decrement[$CellContext`x]], "RightArrowKeyDown" :> If[
              And[
               Not[$CellContext`pause], 
               Not[$CellContext`gameOver], 
               $CellContext`bRight[$CellContext`n, $CellContext`p, \
$CellContext`x, $CellContext`y, 
                Hold[$CellContext`board]]], 
              Increment[$CellContext`x]], "DownArrowKeyDown" :> If[
              And[
               Not[$CellContext`pause], 
               Not[$CellContext`gameOver], 
               $CellContext`bRotateClockwise[$CellContext`n, $CellContext`p, \
$CellContext`x, $CellContext`y, 
                Hold[$CellContext`board]]], Increment[$CellContext`p]; 
              If[$CellContext`p == 5, $CellContext`p = 1]], "UpArrowKeyDown" :> 
            If[
              And[
               Not[$CellContext`pause], 
               Not[$CellContext`gameOver], 
               $CellContext`bRotateAnticlock[$CellContext`n, $CellContext`p, \
$CellContext`x, $CellContext`y, 
                Hold[$CellContext`board]]], Decrement[$CellContext`p]; 
              If[$CellContext`p == 0, $CellContext`p = 4]], {"KeyDown", " "} :> 
            If[
              And[
               Not[$CellContext`pause], 
               Not[$CellContext`gameOver], 
               $CellContext`bDown[$CellContext`n, $CellContext`p, \
$CellContext`x, $CellContext`y, 
                Hold[$CellContext`board]]], 
              Decrement[$CellContext`y], 
              $CellContext`newBlock[
               
               Hold[$CellContext`n, $CellContext`p, $CellContext`x, \
$CellContext`y, $CellContext`board, $CellContext`score, \
$CellContext`gameOver, $CellContext`nextItem, $CellContext`pause]]], 
            "EscapeKeyDown" :> {
              $CellContext`newGame[
               
               Hold[$CellContext`n, $CellContext`p, $CellContext`x, \
$CellContext`y, $CellContext`board, $CellContext`nextItem, \
$CellContext`gameOver, $CellContext`pause, $CellContext`num]]}}]], \
$CellContext`newGame[
         Hold[
          Pattern[$CellContext`n, 
           Blank[]], 
          Pattern[$CellContext`p, 
           Blank[]], 
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`y, 
           Blank[]], 
          Pattern[$CellContext`board, 
           Blank[]], 
          Pattern[$CellContext`nextItem, 
           Blank[]], 
          Pattern[$CellContext`gameOver, 
           Blank[]], 
          Pattern[$CellContext`pause, 
           Blank[]], 
          Pattern[$CellContext`num, 
           Blank[]]]] := {$CellContext`initBoard[
           
           Hold[$CellContext`board, $CellContext`num]]; {$CellContext`n, \
$CellContext`p, $CellContext`x, $CellContext`y} = {$CellContext`nextItem, 2, 
            6, 22}; $CellContext`nextItem = 
          RandomInteger[6] + 1; $CellContext`gameOver = 
          False; $CellContext`pause = False}, $CellContext`initBoard[
         Hold[
          Pattern[$CellContext`board, 
           Blank[]], 
          Pattern[$CellContext`num, 
           Blank[]]]] := {$CellContext`board = Table[
           If[
            
            Or[$CellContext`i <= 3, $CellContext`j <= 3, $CellContext`i >= 
             14, $CellContext`j >= 24], 9, 0], {$CellContext`i, 1, 
            16}, {$CellContext`j, 1, 28}], 
         Table[Part[$CellContext`board, $CellContext`i, 24] = 0; 
           Part[$CellContext`board, $CellContext`i, 25] = 0; 
           Part[$CellContext`board, $CellContext`i, 26] = 0, {$CellContext`i, 
            7, 10}]; Table[
          Part[$CellContext`board, $CellContext`i, 25] = 
           0, {$CellContext`i, 1, 16}]; Part[$CellContext`board, 6, 25] = 9, 
         Part[$CellContext`board, 11, 25] = 9, 
         Table[
          If[
          Mod[$CellContext`j + $CellContext`i, 2] == 0, 
           Part[$CellContext`board, $CellContext`j, $CellContext`i + 3] = 
           9], {$CellContext`i, 1, $CellContext`num}, {$CellContext`j, 4, 
           13}]}, $CellContext`showSquare[{
          Pattern[$CellContext`i, 
           Blank[]], 
          Pattern[$CellContext`j, 
           Blank[]]}, 
         Pattern[$CellContext`v, 
          Blank[]]] := {
         $CellContext`color[$CellContext`v], 
         Rectangle[{$CellContext`i + 0.05, $CellContext`j + 
           0.05}, {$CellContext`i + 0.95, $CellContext`j + 
           0.95}]}, $CellContext`color[
         Pattern[$CellContext`v, 
          Blank[]]] := 
       Switch[$CellContext`v, 0, Black, 1, Yellow, 2, Blue, 3, Magenta, 4, 
         Cyan, 5, Red, 6, Orange, 7, Green, 9, Gray, 
         Blank[], Gray], $CellContext`smallBoard = {{9, 9, 9, 9, 9, 9}, {9, 0,
         0, 0, 0, 9}, {9, 0, 0, 0, 0, 9}, {9, 0, 0, 0, 0, 9}, {9, 0, 0, 0, 0, 
        9}, {9, 9, 9, 9, 9, 9}}, $CellContext`bDown[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]], 
         Hold[
          Pattern[$CellContext`board, 
           
           Blank[]]]] := $CellContext`bMoveTo[$CellContext`n, $CellContext`p, \
$CellContext`x, $CellContext`y - 1, 
         Hold[$CellContext`board]], $CellContext`bMoveTo[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]], 
         Hold[
          Pattern[$CellContext`board, 
           Blank[]]]] := Total[
          Table[
          Part[$CellContext`allBlocks, $CellContext`n, $CellContext`p, \
$CellContext`i, $CellContext`j] 
           Part[$CellContext`board, $CellContext`i + $CellContext`x, \
$CellContext`j + $CellContext`y], {$CellContext`i, 1, 4}, {$CellContext`j, 1, 
            4}], 2] == 0, $CellContext`allBlocks = CompressedData["
1:eJydS9sNwCAIRECZoyt1BBfo/n+VgkL6UZNeOLwHHv06OwOADHJiURbdDtXF
ixWlwOX6gmMQ41il+hxlj1ZHT0BEcUyTkWlPS6ebCWbjT18HoqwvfvetjedZ
E828R7seRHQCYpmJfX8DUB0Dfg==
        "], $CellContext`newBlock[
         Hold[
          Pattern[$CellContext`n, 
           Blank[]], 
          Pattern[$CellContext`p, 
           Blank[]], 
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`y, 
           Blank[]], 
          Pattern[$CellContext`board, 
           Blank[]], 
          Pattern[$CellContext`score, 
           Blank[]], 
          Pattern[$CellContext`gameOver, 
           Blank[]], 
          Pattern[$CellContext`nextItem, 
           Blank[]], 
          Pattern[$CellContext`pause, 
           Blank[]]]] := {
         If[
          And[
           Not[$CellContext`pause], 
           
           Not[$CellContext`gameOver]], \
$CellContext`updateBoard[$CellContext`n, $CellContext`p, $CellContext`x, \
$CellContext`y, 
            
            Hold[$CellContext`board, $CellContext`score]]; \
$CellContext`gameOver = $CellContext`bGameOver[$CellContext`nextItem, 2, 
             Hold[$CellContext`board]]; 
          If[$CellContext`gameOver == 
            False, {$CellContext`n, $CellContext`p, $CellContext`x, \
$CellContext`y} = {$CellContext`nextItem, 2, 6, 22}; $CellContext`nextItem = 
             RandomInteger[6] + 1]]}, $CellContext`updateBoard[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]], 
         Hold[
          Pattern[$CellContext`board, 
           Blank[]], 
          Pattern[$CellContext`score, 
           Blank[]]]] := {Table[
           AddTo[
            
            Part[$CellContext`board, $CellContext`i + $CellContext`x, \
$CellContext`j + $CellContext`y], 
            
            Part[$CellContext`allBlocks, $CellContext`n, $CellContext`p, \
$CellContext`i, $CellContext`j]], {$CellContext`i, 1, 4}, {$CellContext`j, 1, 
            4}]; AddTo[$CellContext`score, 10 + 100 (2^Sum[
                $CellContext`updateLine[$CellContext`i, 
                 Hold[$CellContext`board]], {$CellContext`i, $CellContext`y + 
                 4, $CellContext`y + 1, -1}] - 1)]}, $CellContext`updateLine[
         Pattern[$CellContext`line, 
          Blank[]], 
         Hold[
          Pattern[$CellContext`board, 
           Blank[]]]] := If[
         And[$CellContext`line <= 23, $CellContext`line >= 4, Apply[And, 
            Table[
            Part[$CellContext`board, $CellContext`i, $CellContext`line] != 
             0, {$CellContext`i, 4, 13}]] == True], 
         Table[Part[$CellContext`board, $CellContext`i, $CellContext`j] = 
           Part[$CellContext`board, $CellContext`i, $CellContext`j + 
             1], {$CellContext`i, 4, 13}, {$CellContext`j, $CellContext`line, 
            22}]; Table[
          Part[$CellContext`board, $CellContext`i, 23] = 
           0, {$CellContext`i, 4, 13}]; 1, 0], $CellContext`bGameOver[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Hold[
          Pattern[$CellContext`board, 
           Blank[]]]] := Not[
         $CellContext`bMoveTo[$CellContext`n, $CellContext`p, 6, 22, 
          Hold[$CellContext`board]]], $CellContext`showBoard[
         Hold[
          Pattern[$CellContext`board, 
           Blank[]]]] := Table[
         $CellContext`showSquare[{$CellContext`i, $CellContext`j}, 
          
          Part[$CellContext`board, $CellContext`i, $CellContext`j]], \
{$CellContext`i, 3, 14}, {$CellContext`j, 3, 25}], $CellContext`showDropBlock[
        
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Table[
         If[
         Part[$CellContext`allBlocks, $CellContext`n, $CellContext`p, \
$CellContext`i, $CellContext`j] != 0, 
          $CellContext`showSquare[{$CellContext`i + $CellContext`x, \
$CellContext`j + $CellContext`y}, 
           
           Part[$CellContext`allBlocks, $CellContext`n, $CellContext`p, \
$CellContext`i, $CellContext`j]], Black], {$CellContext`i, 1, 
          4}, {$CellContext`j, 1, 4}], $CellContext`showHintBlock[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Table[
         $CellContext`showSquare[{$CellContext`i + $CellContext`x, \
$CellContext`j + $CellContext`y}, 
          
          Part[$CellContext`allBlocks, $CellContext`n, $CellContext`p, \
$CellContext`i, $CellContext`j]], {$CellContext`i, 1, 4}, {$CellContext`j, 1, 
          4}], $CellContext`bLeft[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]], 
         Hold[
          Pattern[$CellContext`board, 
           
           Blank[]]]] := $CellContext`bMoveTo[$CellContext`n, $CellContext`p, \
$CellContext`x - 1, $CellContext`y, 
         Hold[$CellContext`board]], $CellContext`bRight[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]], 
         Hold[
          Pattern[$CellContext`board, 
           
           Blank[]]]] := $CellContext`bMoveTo[$CellContext`n, $CellContext`p, \
$CellContext`x + 1, $CellContext`y, 
         Hold[$CellContext`board]], $CellContext`bRotateClockwise[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]], 
         Hold[
          Pattern[$CellContext`board, 
           Blank[]]]] := 
       Module[{$CellContext`tp}, $CellContext`tp = $CellContext`p + 1; 
         If[$CellContext`tp == 5, $CellContext`tp = 
           1]; $CellContext`bMoveTo[$CellContext`n, $CellContext`tp, \
$CellContext`x, $CellContext`y, 
           Hold[$CellContext`board]]], $CellContext`bRotateAnticlock[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]], 
         Hold[
          Pattern[$CellContext`board, 
           Blank[]]]] := 
       Module[{$CellContext`tp}, $CellContext`tp = $CellContext`p - 1; 
         If[$CellContext`tp == 0, $CellContext`tp = 
           4]; $CellContext`bMoveTo[$CellContext`n, $CellContext`tp, \
$CellContext`x, $CellContext`y, 
           Hold[$CellContext`board]]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.688349840352673*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 751},
WindowMargins->{{12, Automatic}, {Automatic, 24}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 103, 1, 92, "Title"],
Cell[CellGroupData[{
Cell[708, 27, 132, 1, 63, "Subchapter"],
Cell[843, 30, 37991, 987, 2553, "Input"],
Cell[CellGroupData[{
Cell[38859, 1021, 1348, 35, 159, "Input"],
Cell[40210, 1058, 19267, 453, 599, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

