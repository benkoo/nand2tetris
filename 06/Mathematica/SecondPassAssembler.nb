(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17928,        436]
NotebookOptionsPosition[     16909,        398]
NotebookOutlinePosition[     17267,        414]
CellTagsIndexPosition[     17224,        411]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Go", " ", "through", " ", "textLineArray", " ", "and", " ", "create", " ",
     "a", " ", "new", " ", "symbolTable", " ", "as", " ", "well", " ", "as", 
    " ", "a", " ", "Label", " ", "removal", " ", 
    RowBox[{"array", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CollectLabels", "[", 
    RowBox[{"textLineArray_", ",", " ", "symbolTable_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"n", "=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"romAddress", " ", "=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"labelCandidatesIndexArray", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"labelCandidatesArray", "=", "symbolTable"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"labelCandidate", "=", "\"\<\>\""}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"n", "<=", 
         RowBox[{"Length", "[", "textLineArray", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"StringStartsQ", "[", 
            RowBox[{
             RowBox[{
             "textLineArray", "\[LeftDoubleBracket]", "n", 
              "\[RightDoubleBracket]"}], ",", " ", "\"\<(\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "THEN", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"romAddress", "=", 
             RowBox[{"romAddress", "-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"labelCandidate", " ", "=", 
             RowBox[{"StringDrop", "[", 
              RowBox[{
               RowBox[{"StringDrop", "[", 
                RowBox[{
                 RowBox[{
                 "textLineArray", "\[LeftDoubleBracket]", "n", 
                  "\[RightDoubleBracket]"}], ",", "1"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", "labelCandidatesArray", "]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
                "labelCandidate"}], " ", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "If", " ", "this", " ", "is", " ", "a", " ", "member", " ", 
                 "of", " ", "SymbolTable"}], ",", " ", "then", ",", " ", 
                RowBox[{
                 RowBox[{"don", "'"}], "t", " ", "do", " ", "anything"}]}], 
               " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
               "labelCandidate", " ", "<>", " ", "\"\<Already Exists\>\""}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "Else", " ", "if", " ", "this", " ", "is", " ", "a", " ", 
                 "new", " ", "symbol", " ", "member"}], ","}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Candidate Label:\>\"", "<>", " ", "\"\<Line[\>\"", "<>",
                   " ", 
                  RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<]\>\"", " ",
                   "<>", "labelCandidate", "<>", " ", "\"\<->\>\"", "<>", " ", 
                  RowBox[{"ToString", "[", "romAddress", "]"}]}], "]"}], " ", 
                ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"labelCandidatesArray", ",", 
                 RowBox[{"{", 
                  RowBox[{"labelCandidate", ",", "romAddress"}], "}"}]}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"labelCandidatesIndexArray", ",", 
                 RowBox[{"{", "n", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "ELSE", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"romAddress", "++"}], " ", "\[IndentingNewLine]", 
         RowBox[{"n", "++"}]}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "labelCandidatesArray", ",", " ", "labelCandidatesIndexArray"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.666882120707466*^9, 3.6668821263716183`*^9}, {
  3.666882160788023*^9, 3.666882186912692*^9}, {3.6668822172830677`*^9, 
  3.666882235120153*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6668839084620447`*^9, 3.666883988663362*^9}, {
   3.6668840585048237`*^9, 3.666884077217606*^9}, 3.666884191453286*^9, {
   3.666884259499053*^9, 3.666884262928982*^9}, {3.6668844465865917`*^9, 
   3.666884529241643*^9}, {3.666884587093356*^9, 3.666884689445179*^9}, {
   3.666884831781748*^9, 3.666884874574876*^9}, {3.666884907793552*^9, 
   3.666884957081893*^9}, 3.666904353168388*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Given", " ", "binary", " ", "string", " ", "represented", " ", "Hack", 
     " ", "code"}], ",", " ", 
    RowBox[{
    "create", " ", "its", " ", "textual", " ", "representation", " ", 
     "including", " ", "end", " ", "of", " ", 
     RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"HackCodeInStringWithUpdatedSymbols", "[", 
     RowBox[{"rawText_", ",", " ", "initialSymbols_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"arrayOfLines", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"asmArray", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"binaryCodeArray", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"binaryCodeString", "=", "\"\<\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"rawTextualInstructions", "=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"instructionSetWithoutLineComments", "=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"labelCollectionResult", "=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"updatedSymbols", "=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"symbolsWithRamAddress", " ", "=", 
         RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arrayOfLines", "=", " ", 
        RowBox[{"StringSplit", "[", 
         RowBox[{"rawText", ",", " ", "\"\<\\n\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "arrayOfLines", "]"}], "\[LessEqual]", "0"}],
          ",", " ", "\[IndentingNewLine]", 
         RowBox[{"(*", "Then", "*)"}], " ", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<No Text to be translated\>\"", "]"}], 
          ";", " ", 
          RowBox[{"Return", " ", "Null"}]}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rawTextualInstructions", "=", 
        RowBox[{"CollectInstruction", "[", "arrayOfLines", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", "rawTextualInstructions", "]"}], ";"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"labelCollectionResult", " ", "=", 
        RowBox[{"CollectLabels", "[", 
         RowBox[{"rawTextualInstructions", ",", "initialSymbols"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"updatedSymbols", "=", " ", 
        RowBox[{
        "labelCollectionResult", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"instructionSetWithoutLineComments", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"StripComment", ",", 
          RowBox[{"Delete", "[", 
           RowBox[{"rawTextualInstructions", ",", " ", 
            RowBox[{
            "labelCollectionResult", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"symbolsWithRamAddress", "=", 
        RowBox[{"CollectRamAddress", "[", 
         RowBox[{
         "instructionSetWithoutLineComments", ",", " ", "updatedSymbols"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"binaryCodeArray", "=", 
        RowBox[{"TranslateInstructionWithUpdatedSymbols", "[", 
         RowBox[{
         "instructionSetWithoutLineComments", ",", "\[IndentingNewLine]", 
          RowBox[{
          "labelCollectionResult", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", "binaryCodeArray", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "binaryCodeArray", "]"}], "\[LessEqual]", 
          "0"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"(*", "Then", "*)"}], " ", 
         RowBox[{"Print", "[", "\"\<No Code to be translated\>\"", "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"(*", "Else", "*)"}], " ", 
         RowBox[{"binaryCodeString", " ", "=", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "<>", "\"\<\\n\>\""}], ")"}], "&"}], ",", " ", 
             "binaryCodeArray"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "binaryCodeString"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.66688195209089*^9, 3.6668819555206337`*^9}, {
  3.6668822876602182`*^9, 3.666882329170483*^9}, {3.666882370939492*^9, 
  3.6668824807621202`*^9}, {3.666882622107411*^9, 3.6668826619486217`*^9}, {
  3.666882741518502*^9, 3.666882742902194*^9}, {3.666882790589274*^9, 
  3.6668828673569517`*^9}, {3.6668829111788692`*^9, 3.666882968283072*^9}, {
  3.666883115614708*^9, 3.666883118069502*^9}, {3.666883310809683*^9, 
  3.666883313183803*^9}, {3.6668850137391987`*^9, 3.6668850604985313`*^9}, {
  3.6669048111458597`*^9, 3.666904836140476*^9}, {3.666904910486253*^9, 
  3.6669049150767393`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Testing", " ", "Code", " ", "using", " ", "the", " ", 
    RowBox[{"Add", ".", "asm"}], " ", "Hack", " ", "Assembly", " ", "code"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rawText", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<../add/\>\"", 
        "<>", "\"\<Add.asm\>\""}], ",", " ", "\"\<Text\>\""}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"binaryCodeInString", "=", 
     RowBox[{"HackCodeInStringWithUpdatedSymbols", "[", 
      RowBox[{"rawText", ",", " ", "SymbolTable"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Add.hack\>\""}], 
     ",", "binaryCodeInString", ",", "\"\<Text\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.666882058720066*^9, {3.666882994476836*^9, 3.6668829994491787`*^9}}],

Cell[BoxData["\<\"Not a new symbol:2\"\>"], "Print",
 CellChangeTimes->{3.666885122062189*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Testing", " ", "Code", " ", "using", " ", "the", " ", 
    RowBox[{"MaxL", ".", "asm"}], " ", "Hack", " ", "Assembly", " ", "code"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rawText", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<../max/\>\"", 
        "<>", "\"\<Max.asm\>\""}], ",", " ", "\"\<Text\>\""}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"binaryCodeInString", "=", 
     RowBox[{"HackCodeInStringWithUpdatedSymbols", "[", 
      RowBox[{"rawText", ",", " ", "SymbolTable"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Max.hack\>\""}], 
     ",", "binaryCodeInString", ",", "\"\<Text\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.666883197466*^9, 3.666883223183661*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"To be used to look up address:R0\"\>"], "Print",
 CellChangeTimes->{{3.666883209899167*^9, 3.6668832431624727`*^9}, 
   3.666883322808284*^9, 3.666883392169442*^9}],

Cell[BoxData["\<\"To be used to look up address:R1\"\>"], "Print",
 CellChangeTimes->{{3.666883209899167*^9, 3.6668832431624727`*^9}, 
   3.666883322808284*^9, 3.6668833921748753`*^9}],

Cell[BoxData["\<\"To be used to look up address:OUTPUT_FIRST\"\>"], "Print",
 CellChangeTimes->{{3.666883209899167*^9, 3.6668832431624727`*^9}, 
   3.666883322808284*^9, 3.666883392182309*^9}],

Cell[BoxData["\<\"To be used to look up address:R1\"\>"], "Print",
 CellChangeTimes->{{3.666883209899167*^9, 3.6668832431624727`*^9}, 
   3.666883322808284*^9, 3.6668833921849747`*^9}],

Cell[BoxData["\<\"To be used to look up address:OUTPUT_D\"\>"], "Print",
 CellChangeTimes->{{3.666883209899167*^9, 3.6668832431624727`*^9}, 
   3.666883322808284*^9, 3.6668833921877327`*^9}],

Cell[BoxData["\<\"To be used to look up address:R0\"\>"], "Print",
 CellChangeTimes->{{3.666883209899167*^9, 3.6668832431624727`*^9}, 
   3.666883322808284*^9, 3.666883392190456*^9}],

Cell[BoxData["\<\"To be used to look up address:R2\"\>"], "Print",
 CellChangeTimes->{{3.666883209899167*^9, 3.6668832431624727`*^9}, 
   3.666883322808284*^9, 3.6668833921954327`*^9}],

Cell[BoxData["\<\"To be used to look up address:INFINITE_LOOP\"\>"], "Print",
 CellChangeTimes->{{3.666883209899167*^9, 3.6668832431624727`*^9}, 
   3.666883322808284*^9, 3.666883392200408*^9}]
}, Open  ]],

Cell[BoxData["\<\"/Users/bkoo/Documents/Workspace/GitRepos/nand2tetris/06/\
Mathematica/Max.hack\"\>"], "Output",
 CellChangeTimes->{{3.666883209962481*^9, 3.666883243214982*^9}, 
   3.666883322858802*^9, 3.666883392221766*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Testing", " ", "Code", " ", "using", " ", "the", " ", 
    RowBox[{"RectL", ".", "asm"}], " ", "Hack", " ", "Assembly", " ", 
    "code"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rawText", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<../rect/\>\"", 
        "<>", "\"\<Rect.asm\>\""}], ",", " ", "\"\<Text\>\""}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"binaryCodeInString", "=", 
     RowBox[{"HackCodeInStringWithUpdatedSymbols", "[", 
      RowBox[{"rawText", ",", "SymbolTable"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Rect.hack\>\""}], 
     ",", "binaryCodeInString", ",", "\"\<Text\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.666883539387471*^9, 3.666883553981019*^9}}],

Cell[BoxData["\<\"Not a new symbol:0\"\>"], "Print",
 CellChangeTimes->{3.6668835556364517`*^9, 3.666885071387656*^9}]
}, Open  ]]
},
WindowSize->{808, 811},
WindowMargins->{{230, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5044, 107, 556, "Input"],
Cell[5605, 129, 438, 6, 28, "Input"],
Cell[6046, 137, 5748, 122, 709, "Input"],
Cell[CellGroupData[{
Cell[11819, 263, 1019, 26, 80, "Input"],
Cell[12841, 291, 94, 1, 22, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12972, 297, 990, 25, 80, "Input"],
Cell[CellGroupData[{
Cell[13987, 326, 182, 2, 22, "Print"],
Cell[14172, 330, 184, 2, 22, "Print"],
Cell[14359, 334, 192, 2, 22, "Print"],
Cell[14554, 338, 184, 2, 22, "Print"],
Cell[14741, 342, 190, 2, 22, "Print"],
Cell[14934, 346, 182, 2, 22, "Print"],
Cell[15119, 350, 184, 2, 22, "Print"],
Cell[15306, 354, 193, 2, 22, "Print"]
}, Open  ]],
Cell[15514, 359, 227, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15778, 367, 994, 25, 80, "Input"],
Cell[16775, 394, 118, 1, 22, "Print"]
}, Open  ]]
}
]
*)

